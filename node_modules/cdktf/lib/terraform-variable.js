"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TerraformVariable = exports.VariableType = void 0;
const terraform_element_1 = require("./terraform-element");
const util_1 = require("./util");
const tokens_1 = require("./tokens");
/**
 * @experimental
 */
class VariableType {
    /**
     * @experimental
     */
    static list(type) {
        return `list(${type})`;
    }
    /**
     * @experimental
     */
    static map(type) {
        return `map(${type})`;
    }
    /**
     * @experimental
     */
    static set(type) {
        return `set(${type})`;
    }
    /**
     * @experimental
     */
    static tuple(...elements) {
        return `tuple(${elements.join(", ")})`;
    }
    /**
     * @experimental
     */
    static object(attributes) {
        return `object({${Object.keys(attributes).map(k => k + "=" + attributes[k]).join(", ")}})`;
    }
}
exports.VariableType = VariableType;
/**
 * @experimental
 */
VariableType.STRING = 'string';
/**
 * @experimental
 */
VariableType.NUMBER = 'number';
/**
 * @experimental
 */
VariableType.BOOL = 'bool';
/**
 * @experimental
 */
VariableType.ANY = 'any';
/**
 * @experimental
 */
VariableType.LIST = 'list';
/**
 * @experimental
 */
VariableType.MAP = 'map';
/**
 * @experimental
 */
VariableType.SET = 'set';
/**
 * @experimental
 */
VariableType.LIST_STRING = 'list(string)';
/**
 * @experimental
 */
VariableType.LIST_NUMBER = 'list(number)';
/**
 * @experimental
 */
VariableType.LIST_BOOL = 'list(bool)';
/**
 * @experimental
 */
VariableType.MAP_STRING = 'map(string)';
/**
 * @experimental
 */
VariableType.MAP_NUMBER = 'map(number)';
/**
 * @experimental
 */
VariableType.MAP_BOOL = 'map(bool)';
/**
 * @experimental
 */
VariableType.SET_STRING = 'set(string)';
/**
 * @experimental
 */
VariableType.SET_NUMBER = 'set(number)';
/**
 * @experimental
 */
VariableType.SET_BOOL = 'set(bool)';
/**
 * @experimental
 */
class TerraformVariable extends terraform_element_1.TerraformElement {
    /**
     * @experimental
     */
    constructor(scope, id, config) {
        super(scope, id);
        this.default = config.default;
        this.description = config.description;
        this.type = config.type;
    }
    /**
     * @experimental
     */
    get stringValue() {
        return tokens_1.Token.asString(this.interpolation());
    }
    /**
     * @experimental
     */
    get numberValue() {
        return tokens_1.Token.asNumber(this.interpolation());
    }
    /**
     * @experimental
     */
    get listValue() {
        return tokens_1.Token.asList(this.interpolation());
    }
    /**
     * @experimental
     */
    get booleanValue() {
        return tokens_1.Token.asString(this.interpolation());
    }
    /**
     * @experimental
     */
    get value() {
        return tokens_1.Token.asAny(this.interpolation());
    }
    interpolation() {
        return `\${var.${this.friendlyUniqueId}}`;
    }
    /**
     * @experimental
     */
    synthesizeAttributes() {
        return {
            default: this.default,
            description: this.description,
            type: this.type
        };
    }
    /**
     * @experimental
     */
    toTerraform() {
        return {
            variable: {
                [this.friendlyUniqueId]: util_1.deepMerge(util_1.keysToSnakeCase(this.synthesizeAttributes()), this.rawOverrides)
            }
        };
    }
}
exports.TerraformVariable = TerraformVariable;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVycmFmb3JtLXZhcmlhYmxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsidGVycmFmb3JtLXZhcmlhYmxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUNBLDJEQUF1RDtBQUN2RCxpQ0FBbUQ7QUFDbkQscUNBQWlDOzs7O0FBRWpDLE1BQXNCLFlBQVk7Ozs7SUFzQnZCLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBWTtRQUMzQixPQUFPLFFBQVEsSUFBSSxHQUFHLENBQUM7SUFDM0IsQ0FBQzs7OztJQUVNLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBWTtRQUMxQixPQUFPLE9BQU8sSUFBSSxHQUFHLENBQUM7SUFDMUIsQ0FBQzs7OztJQUVNLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBWTtRQUMxQixPQUFPLE9BQU8sSUFBSSxHQUFHLENBQUM7SUFDMUIsQ0FBQzs7OztJQUVNLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxRQUFrQjtRQUNyQyxPQUFPLFNBQVMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO0lBQzNDLENBQUM7Ozs7SUFFTSxNQUFNLENBQUMsTUFBTSxDQUFDLFVBQW9DO1FBQ3JELE9BQU8sV0FBVyxNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7SUFDL0YsQ0FBQzs7QUF4Q0wsb0NBeUNDOzs7O0FBeEMwQixtQkFBTSxHQUFHLFFBQVEsQ0FBQzs7OztBQUNsQixtQkFBTSxHQUFHLFFBQVEsQ0FBQzs7OztBQUNsQixpQkFBSSxHQUFHLE1BQU0sQ0FBQzs7OztBQUNkLGdCQUFHLEdBQUcsS0FBSyxDQUFDOzs7O0FBRVosaUJBQUksR0FBRyxNQUFNLENBQUM7Ozs7QUFDZCxnQkFBRyxHQUFHLEtBQUssQ0FBQzs7OztBQUNaLGdCQUFHLEdBQUcsS0FBSyxDQUFDOzs7O0FBRVosd0JBQVcsR0FBRyxjQUFjLENBQUM7Ozs7QUFDN0Isd0JBQVcsR0FBRyxjQUFjLENBQUM7Ozs7QUFDN0Isc0JBQVMsR0FBRyxZQUFZLENBQUM7Ozs7QUFFekIsdUJBQVUsR0FBRyxhQUFhLENBQUM7Ozs7QUFDM0IsdUJBQVUsR0FBRyxhQUFhLENBQUM7Ozs7QUFDM0IscUJBQVEsR0FBRyxXQUFXLENBQUM7Ozs7QUFFdkIsdUJBQVUsR0FBRyxhQUFhLENBQUM7Ozs7QUFDM0IsdUJBQVUsR0FBRyxhQUFhLENBQUM7Ozs7QUFDM0IscUJBQVEsR0FBRyxXQUFXLENBQUM7Ozs7QUFxRGxELE1BQWEsaUJBQWtCLFNBQVEsb0NBQWdCOzs7O0lBS25ELFlBQVksS0FBZ0IsRUFBRSxFQUFVLEVBQUUsTUFBK0I7UUFDckUsS0FBSyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQztRQUVqQixJQUFJLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUM7UUFDOUIsSUFBSSxDQUFDLFdBQVcsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDO1FBQ3RDLElBQUksQ0FBQyxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQztJQUM1QixDQUFDOzs7O0lBRUQsSUFBVyxXQUFXO1FBQ2xCLE9BQU8sY0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQztJQUNoRCxDQUFDOzs7O0lBRUQsSUFBVyxXQUFXO1FBQ2xCLE9BQU8sY0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQztJQUNoRCxDQUFDOzs7O0lBRUQsSUFBVyxTQUFTO1FBQ2hCLE9BQU8sY0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQztJQUM5QyxDQUFDOzs7O0lBRUQsSUFBVyxZQUFZO1FBQ25CLE9BQU8sY0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQW1CLENBQUE7SUFDakUsQ0FBQzs7OztJQUVELElBQVcsS0FBSztRQUNaLE9BQU8sY0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRU8sYUFBYTtRQUNqQixPQUFPLFVBQVUsSUFBSSxDQUFDLGdCQUFnQixHQUFHLENBQUE7SUFDN0MsQ0FBQzs7OztJQUVNLG9CQUFvQjtRQUN2QixPQUFPO1lBQ0gsT0FBTyxFQUFFLElBQUksQ0FBQyxPQUFPO1lBQ3JCLFdBQVcsRUFBRSxJQUFJLENBQUMsV0FBVztZQUM3QixJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUk7U0FDbEIsQ0FBQTtJQUNMLENBQUM7Ozs7SUFFTSxXQUFXO1FBQ2QsT0FBTztZQUNILFFBQVEsRUFBRTtnQkFDTixDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLGdCQUFTLENBQUMsc0JBQWUsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUM7YUFDdEc7U0FDSixDQUFDO0lBQ04sQ0FBQztDQUNKO0FBcERELDhDQW9EQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gXCJjb25zdHJ1Y3RzXCI7XG5pbXBvcnQgeyBUZXJyYWZvcm1FbGVtZW50IH0gZnJvbSBcIi4vdGVycmFmb3JtLWVsZW1lbnRcIjtcbmltcG9ydCB7IGtleXNUb1NuYWtlQ2FzZSwgZGVlcE1lcmdlIH0gZnJvbSBcIi4vdXRpbFwiXG5pbXBvcnQgeyBUb2tlbiB9IGZyb20gXCIuL3Rva2Vuc1wiO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgVmFyaWFibGVUeXBlIHtcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFNUUklORyA9ICdzdHJpbmcnO1xuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgTlVNQkVSID0gJ251bWJlcic7XG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBCT09MID0gJ2Jvb2wnO1xuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgQU5ZID0gJ2FueSc7XG5cbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IExJU1QgPSAnbGlzdCc7XG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBNQVAgPSAnbWFwJztcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFNFVCA9ICdzZXQnO1xuXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBMSVNUX1NUUklORyA9ICdsaXN0KHN0cmluZyknO1xuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgTElTVF9OVU1CRVIgPSAnbGlzdChudW1iZXIpJztcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IExJU1RfQk9PTCA9ICdsaXN0KGJvb2wpJztcblxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgTUFQX1NUUklORyA9ICdtYXAoc3RyaW5nKSc7XG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBNQVBfTlVNQkVSID0gJ21hcChudW1iZXIpJztcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IE1BUF9CT09MID0gJ21hcChib29sKSc7XG5cbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFNFVF9TVFJJTkcgPSAnc2V0KHN0cmluZyknO1xuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgU0VUX05VTUJFUiA9ICdzZXQobnVtYmVyKSc7XG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBTRVRfQk9PTCA9ICdzZXQoYm9vbCknO1xuXG4gICAgcHVibGljIHN0YXRpYyBsaXN0KHR5cGU6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gYGxpc3QoJHt0eXBlfSlgO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgbWFwKHR5cGU6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gYG1hcCgke3R5cGV9KWA7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBzZXQodHlwZTogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiBgc2V0KCR7dHlwZX0pYDtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIHR1cGxlKC4uLmVsZW1lbnRzOiBzdHJpbmdbXSkge1xuICAgICAgICByZXR1cm4gYHR1cGxlKCR7ZWxlbWVudHMuam9pbihcIiwgXCIpfSlgO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgb2JqZWN0KGF0dHJpYnV0ZXM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nfSkge1xuICAgICAgICByZXR1cm4gYG9iamVjdCh7JHtPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5tYXAoayA9PiBrICsgXCI9XCIgKyBhdHRyaWJ1dGVzW2tdKS5qb2luKFwiLCBcIil9fSlgO1xuICAgIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBUZXJyYWZvcm1WYXJpYWJsZUNvbmZpZyB7XG4gICAgcmVhZG9ubHkgZGVmYXVsdD86IGFueTtcbiAgICByZWFkb25seSBkZXNjcmlwdGlvbj86IHN0cmluZztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgcmVhZG9ubHkgdHlwZT86IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIFRlcnJhZm9ybVZhcmlhYmxlIGV4dGVuZHMgVGVycmFmb3JtRWxlbWVudCB7XG4gICAgcHVibGljIHJlYWRvbmx5IGRlZmF1bHQ/OiBhbnk7XG4gICAgcHVibGljIHJlYWRvbmx5IGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuICAgIHB1YmxpYyByZWFkb25seSB0eXBlPzogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZywgY29uZmlnOiBUZXJyYWZvcm1WYXJpYWJsZUNvbmZpZykge1xuICAgICAgICBzdXBlcihzY29wZSwgaWQpO1xuXG4gICAgICAgIHRoaXMuZGVmYXVsdCA9IGNvbmZpZy5kZWZhdWx0O1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gY29uZmlnLmRlc2NyaXB0aW9uO1xuICAgICAgICB0aGlzLnR5cGUgPSBjb25maWcudHlwZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0IHN0cmluZ1ZhbHVlKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBUb2tlbi5hc1N0cmluZyh0aGlzLmludGVycG9sYXRpb24oKSk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldCBudW1iZXJWYWx1ZSgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gVG9rZW4uYXNOdW1iZXIodGhpcy5pbnRlcnBvbGF0aW9uKCkpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgbGlzdFZhbHVlKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIFRva2VuLmFzTGlzdCh0aGlzLmludGVycG9sYXRpb24oKSk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldCBib29sZWFuVmFsdWUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBUb2tlbi5hc1N0cmluZyh0aGlzLmludGVycG9sYXRpb24oKSkgYXMgYW55IGFzIGJvb2xlYW5cbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0IHZhbHVlKCk6IGFueSB7XG4gICAgICAgIHJldHVybiBUb2tlbi5hc0FueSh0aGlzLmludGVycG9sYXRpb24oKSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbnRlcnBvbGF0aW9uKCk6IGFueSB7XG4gICAgICAgIHJldHVybiBgXFwke3Zhci4ke3RoaXMuZnJpZW5kbHlVbmlxdWVJZH19YFxuICAgIH1cblxuICAgIHB1YmxpYyBzeW50aGVzaXplQXR0cmlidXRlcygpOiB7IFtrZXk6IHN0cmluZ106IGFueSB9IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IHRoaXMuZGVmYXVsdCxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgdHlwZTogdGhpcy50eXBlXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgdG9UZXJyYWZvcm0oKTogYW55IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhcmlhYmxlOiB7XG4gICAgICAgICAgICAgICAgW3RoaXMuZnJpZW5kbHlVbmlxdWVJZF06IGRlZXBNZXJnZShrZXlzVG9TbmFrZUNhc2UodGhpcy5zeW50aGVzaXplQXR0cmlidXRlcygpKSwgdGhpcy5yYXdPdmVycmlkZXMpXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxufSJdfQ==